<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Admin Dashboard - Leads</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f6f9;
  margin: 0;
  padding: 30px;
}

h1 {
  margin-bottom: 20px;
}

table {
  width: 100%;
  border-collapse: collapse;
  background: white;
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

th, td {
  padding: 12px 15px;
  text-align: left;
}

th {
  background: #007bff;
  color: white;
}

tr:nth-child(even) {
  background: #f2f2f2;
}

button {
  background: red;
  color: white;
  border: none;
  padding: 6px 10px;
  border-radius: 6px;
  cursor: pointer;
}
</style>
</head>
<body>

<h1>ðŸ“Š Lead Dashboard</h1>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Email</th>
      <th>Date</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody id="leadTable"></tbody>
</table>

<script>
async function loadLeads() {
  const response = await fetch("/api/leads");
  const leads = await response.json();

  const table = document.getElementById("leadTable");
  table.innerHTML = "";

  leads.slice().reverse().forEach((lead, reverseIndex) => {
    const realIndex = leads.length - 1 - reverseIndex;

    const row = document.createElement("tr");

    row.innerHTML = `
      <td>${lead.name}</td>
      <td>${lead.email}</td>
      <td>${new Date(lead.date).toLocaleString()}</td>
      <td>
        <button onclick="deleteLead(${realIndex})">
          Delete
        </button>
      </td>
    `;

    table.appendChild(row);
  });
}

async function deleteLead(index) {
  if (!confirm("Are you sure you want to delete this lead?")) return;

  await fetch(`/api/leads/${index}`, {
    method: "DELETE"
  });

  loadLeads(); // auto refresh
}

loadLeads();
</script>

</body>
</html>
