<!DOCTYPE html>
<html>
<head>
<title>SnowSkye Dashboard</title>

<style>
body{
font-family:Arial;
background:#0f172a;
color:white;
padding:20px;
}

.box{
background:#1e293b;
padding:20px;
margin-top:20px;
border-radius:10px;
}

button{
background:#2563eb;
color:white;
border:none;
padding:10px;
margin-top:10px;
cursor:pointer;
}

.delete{
background:red;
}

textarea,input{
width:100%;
padding:10px;
margin-top:10px;
}
</style>

</head>
<body>

<h1>SnowSkye Dashboard</h1>

<div class="box">

<h3>Email</h3>
<input id="email" readonly>

<h3>API Key</h3>
<input id="apiKey" readonly>

</div>


<div class="box">

<h3>Edit AI Personality</h3>

<textarea id="prompt"></textarea>

<button onclick="savePrompt()">
Save Prompt
</button>

</div>


<div class="box">

<h3>Install Code</h3>

<textarea id="install"></textarea>

</div>


<div class="box">

<h3>Danger Zone</h3>

<button class="delete"
onclick="deleteAccount()">
Delete Account
</button>

</div>



<script>

const API_URL =
"https://lead-chatbot-gti5.onrender.com";

const apiKey =
localStorage.getItem("snowskye_api_key");


// LOAD CLIENT DATA
fetch(API_URL+"/api/get-client",{

method:"POST",

headers:{
"Content-Type":"application/json"
},

body:JSON.stringify({ apiKey })

})
.then(res=>res.json())
.then(data=>{

document.getElementById("email").value =
data.email;

document.getElementById("apiKey").value =
data.api_key;

document.getElementById("prompt").value =
data.ai_prompt;

document.getElementById("install").value =
`<scr` + `ipt src="${API_URL}/widget.js" data-api-key="${apiKey}"></scr` + `ipt>`;

});


// SAVE PROMPT
function savePrompt(){

const ai_prompt =
document.getElementById("prompt").value;

fetch(API_URL+"/api/update-prompt",{

method:"POST",

headers:{
"Content-Type":"application/json"
},

body:JSON.stringify({

apiKey,
ai_prompt

})

})
.then(res=>res.json())
.then(()=>{

alert("Saved");

});

}


// DELETE ACCOUNT
function deleteAccount(){

if(!confirm("Are you sure?"))
return;

fetch(API_URL+"/api/delete-account",{

method:"POST",

headers:{
"Content-Type":"application/json"
},

body:JSON.stringify({ apiKey })

})
.then(()=>{

alert("Deleted");

localStorage.removeItem(
"snowskye_api_key"
);

location.reload();

});

}

</script>

</body>
</html>
